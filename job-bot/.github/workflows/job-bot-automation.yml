name: 24/7 Automated Job Bot

on:
  schedule:
    # Run every hour (0 minutes past every hour)
    - cron: '0 * * * *'
  workflow_dispatch: # Allow manual triggering
  push:
    branches: [ main ]

jobs:
  job-application-bot:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install Chrome browser
      run: |
        sudo apt-get update
        sudo apt-get install -y wget unzip
        wget -q -O - https://dl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
        sudo sh -c 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google-chrome.list'
        sudo apt-get update
        sudo apt-get install -y google-chrome-stable
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: Create credentials config
      run: |
        cat > user_config.json << EOF
        {
          "personal": {
            "full_name": "${{ secrets.FULL_NAME }}",
            "email": "${{ secrets.EMAIL }}",
            "phone": "${{ secrets.PHONE }}",
            "linkedin": "${{ secrets.LINKEDIN }}",
            "github": "${{ secrets.GITHUB_URL }}",
            "location": "${{ secrets.LOCATION }}"
          },
          "platforms": {
            "twitter": {
              "email": "${{ secrets.TWITTER_EMAIL }}",
              "password": "${{ secrets.TWITTER_PASSWORD }}"
            },
            "indeed": {
              "email": "${{ secrets.INDEED_EMAIL }}",
              "password": "${{ secrets.INDEED_PASSWORD }}"
            },
            "dice": {
              "email": "${{ secrets.DICE_EMAIL }}",
              "password": "${{ secrets.DICE_PASSWORD }}"
            },
            "weworkremotely": {
              "email": "${{ secrets.WEWORKREMOTELY_EMAIL }}",
              "password": "${{ secrets.WEWORKREMOTELY_PASSWORD }}"
            },
            "wellfound": {
              "email": "${{ secrets.WELLFOUND_EMAIL }}",
              "password": "${{ secrets.WELLFOUND_PASSWORD }}"
            }
          },
          "preferences": {
            "job_titles": [
              "DevOps Engineer", "Cloud Engineer", "Site Reliability Engineer (SRE)",
              "Infrastructure Engineer", "Platform Engineer", "AWS Engineer",
              "Kubernetes Administrator", "CI/CD Engineer", "Linux Systems Engineer",
              "Cloud Automation Engineer", "Junior DevOps Associate", "Remote DevOps Intern"
            ],
            "skills": [
              "DevOps", "AWS", "Docker", "Kubernetes", "Python", "Linux", "CI/CD", "Jenkins", "Terraform"
            ],
            "salary_min": "$50,000",
            "remote_only": false,
            "experience_level": "Entry and Mid"
          }
        }
        EOF
        
    - name: Create application proofs directory
      run: mkdir -p application_proofs
      
    - name: Run job bot
      run: |
        export DISPLAY=:99
        Xvfb :99 -screen 0 1920x1080x24 > /dev/null 2>&1 &
        python super_ultimate_bot.py
      env:
        PYTHONPATH: .
        
    - name: Upload application proofs
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: application-proofs-${{ github.run_number }}
        path: |
          application_proofs/
          super_ultimate_applications.txt
          super_ultimate_cycle_log.txt
        retention-days: 30
        
    - name: Send notification
      if: always()
      run: |
        echo "Job bot cycle completed at $(date)"
        echo "Check artifacts for application proofs and logs"
